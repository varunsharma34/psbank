"use strict";(self.webpackChunkpsbank=self.webpackChunkpsbank||[]).push([[22],{5231:function(e,n,t){var r=t(1614),a=t(1889),i=t(7047),c=(t(2791),t(184));n.Z=function(){return(0,c.jsx)(r.Z,{fixed:!0,children:(0,c.jsxs)(a.ZP,{item:!0,xs:12,justifyContent:"center",sx:{marginTop:"20px"},children:[(0,c.jsx)(i.Z,{height:60}),(0,c.jsx)(i.Z,{animation:"wave"}),(0,c.jsx)(i.Z,{animation:!1}),(0,c.jsx)(i.Z,{}),(0,c.jsx)(i.Z,{animation:"wave"}),(0,c.jsx)(i.Z,{animation:!1})]})})}},4851:function(e,n,t){t.d(n,{Z:function(){return x}});var r=t(3906),a=t(195),i=t(9658),c=t(1691),o=t(1889),s=t(6151),u=t(9629),l={formName:"Create Transaction",submitButtonText:"Create",formFields:[{label:"Payee Account Number",name:"destination_account",type:"number",required:{value:!0,message:"Please enter payee account number"},defaultValue:""},{label:"Transaction amount",name:"amount",type:"number",required:{value:!0,message:"Please add amount to be transfered"},defaultValue:""},{label:"Description",name:"description",type:"string",defaultValue:""}]},d=t(184),x=function(e){var n=e.createTransactionFormSubmitHandler,t=e.createTransactionApiError,x=e.openCreateTransactionModal,h=e.handleModalClose;return(0,d.jsx)(r.Z,{isOpen:x,handleClose:h,children:(0,d.jsxs)(a.Z,{children:[t&&(0,d.jsx)(i.Z,{severity:"error",sx:{marginBottom:"20px"},children:t}),(0,d.jsx)(c.Z,{sx:{marginBottom:"20px"},children:"Please provide details below:"}),(0,d.jsx)(u.Z,{data:l,formSubmitHandler:n,children:(0,d.jsx)(o.ZP,{item:!0,xs:12,children:(0,d.jsx)(s.Z,{fullWidth:!0,size:"large",variant:"outlined",onClick:h,children:"Cancel"})})})]})})}},3906:function(e,n,t){var r=t(4164),a=t(9818),i=t(184),c=function(e){var n=e.children,t=e.handleClose,c=e.isOpen;return(0,r.createPortal)((0,i.jsx)(a.Z,{open:c,onClose:t,fullWidth:!0,children:n}),document.body)};c.defaultProps={isOpen:!1},n.Z=c},3389:function(e,n,t){var r=t(4942),a=t(9439),i=t(2791),c=t(4554),o=t(9836),s=t(3382),u=t(8745),l=t(618),d=t(9281),x=t(6890),h=t(7550),p=t(5855),m=t(5527),f=t(6934),Z=t(184),b=function(e){var n=e.data,t=e.tableHeadings,b=i.useState(0),j=(0,a.Z)(b,2),g=j[0],v=j[1],y=i.useState(5),P=(0,a.Z)(y,2),w=P[0],k=P[1],A=g>0?Math.max(0,(1+g)*w-n.length):0,C=(0,f.ZP)(u.Z)((function(e){var n,t=e.theme;return n={},(0,r.Z)(n,"&.".concat(l.Z.head),{backgroundColor:t.palette.common.black,color:t.palette.common.white}),(0,r.Z)(n,"&.".concat(l.Z.body),{fontSize:14}),n})),S=(0,f.ZP)(p.Z)((function(e){return{"&:nth-of-type(odd)":{backgroundColor:e.theme.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}));return(0,Z.jsx)(c.Z,{sx:{width:"100%"},children:(0,Z.jsxs)(m.Z,{sx:{width:"100%",mb:2},children:[(0,Z.jsx)(d.Z,{children:(0,Z.jsxs)(o.Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",children:[t&&t.length&&(0,Z.jsx)(x.Z,{sx:{fontWeight:"bold"},children:(0,Z.jsx)(p.Z,{hover:!0,tabIndex:-1,children:t.map((function(e){return(0,Z.jsx)(C,{component:"th",scope:"row",padding:"normal",children:e.name},e.name)}))})}),(0,Z.jsxs)(s.Z,{children:[n.length?n.slice(g*w,g*w+w).map((function(e){var n="enhanced-table-checkbox-".concat(e.number),t=new Date(e.createdAt),r="".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear());return(0,Z.jsxs)(S,{hover:!0,tabIndex:-1,children:[(0,Z.jsx)(C,{component:"th",id:n,scope:"row",padding:"normal",children:e.number}),(0,Z.jsx)(C,{children:e.amount}),(0,Z.jsx)(C,{children:e.destination_account}),(0,Z.jsx)(C,{children:e.description}),(0,Z.jsx)(C,{children:r})]},e._id)})):(0,Z.jsx)(S,{hover:!0,tabIndex:-1,children:(0,Z.jsx)(u.Z,{colSpan:5,children:"No data"})}),A>0&&(0,Z.jsx)(p.Z,{children:(0,Z.jsx)(u.Z,{colSpan:6})})]})]})}),(0,Z.jsx)(h.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:n.length,rowsPerPage:w,page:g,onPageChange:function(e,n){v(n)},onRowsPerPageChange:function(e){k(parseInt(e.target.value,10)),v(0)}})]})})};b.defaultProps={data:[]},n.Z=b},9629:function(e,n,t){t.d(n,{Z:function(){return b}});var r=t(1889),a=t(7865),i=t(6151),c=t(1134),o=t(1413),s=t(8550),u=t(184),l=function(e){var n=e.name,t=e.control,r=e.label,a=e.type,i=void 0===a?"text":a,l=e.required,d=void 0!==l&&l,x=e.formstate,h=e.register;return(0,u.jsx)(c.Qr,{name:n,control:t,render:function(e){return(0,u.jsx)(s.Z,(0,o.Z)({InputLabelProps:{shrink:"date"===i||e.value},fullWidth:!0,type:i,label:r,variant:"outlined",name:n,error:!!x.errors[n],helperText:x.errors[n]?x.errors[n].message:""},h(n,{required:d})))},defaultValue:""})},d=t(5987),x=t(8096),h=t(4925),p=t(6869),m=t(7071),f=["name","label","control","defaultValue","children","errors"],Z=function(e){var n=e.name,t=e.label,r=e.control,a=e.defaultValue,i=e.children,s=e.errors,l=(0,d.Z)(e,f),Z="".concat(n,"-label");return(0,u.jsxs)(x.Z,(0,o.Z)((0,o.Z)({fullWidth:!0},l),{},{children:[(0,u.jsx)(h.Z,{id:Z,children:t}),(0,u.jsx)(c.Qr,{defaultValue:a,render:function(e){var n=e.field;return(0,u.jsx)(p.Z,(0,o.Z)((0,o.Z)({},n),{},{labelId:Z,label:t,children:i}))},name:n,control:r}),(0,u.jsx)(m.Z,{children:s.type?s.type.message:""})]}))},b=function(e){var n=e.data,t=e.formSubmitHandler,o=e.children,s=n.formFields,d=n.submitButtonText,x=void 0===d?"Submit":d,h=(0,c.cI)(),p=h.register,m=h.handleSubmit,f=h.control,b=h.formState;return(0,u.jsx)("form",{onSubmit:m((function(e){t(e)})),children:(0,u.jsxs)(r.ZP,{container:!0,direction:"column",spacing:2,justifyContent:"center",children:[s.length&&s.map((function(e){return"select"===e.type?(0,u.jsx)(r.ZP,{item:!0,xs:12,children:(0,u.jsx)(Z,{id:e.name,name:e.name,label:e.label,control:f,defaultValue:e.options&&e.options.length&&e.options[0].value,errors:b.errors,error:!!b.errors.type,children:e.options&&e.options.length&&e.options.map((function(e){return(0,u.jsx)(a.Z,{value:e.value,children:e.name},e.value)}))})},e.name):(0,u.jsx)(r.ZP,{item:!0,xs:12,children:(0,u.jsx)(l,{name:e.name,label:e.label,type:e.type,control:f,register:p,formstate:b,required:e.required})},e.name)})),(0,u.jsx)(r.ZP,{item:!0,xs:12,children:(0,u.jsx)(i.Z,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:x})}),o]})})}},6921:function(e,n,t){var r,a=t(4165),i=t(5861),c=t(168),o=t(2348),s=t(5702),u=(0,s.gql)(r||(r=(0,c.Z)(["\n  mutation AddTransaction($data: TransactionInsertInput!) {\n    insertOneTransaction(data: $data) {\n      _id\n      number\n      createdAt\n      amount\n      source_account\n      destination_account\n    }\n  }\n"]))),l=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t,r,i,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.queryVariables,r=void 0===t?{}:t,i=n.headers,c=void 0===i?{}:i,e.next=3,(0,s.request)(o.Z2,u,r,c);case 3:return l=e.sent,e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();n.Z=l},5022:function(e,n,t){t.r(n),t.d(n,{default:function(){return W}});var r,a,i=t(1104),c=t(3433),o=t(4165),s=t(5861),u=t(9439),l=t(2791),d=t(7689),x=t(9526),h=t(4554),p=t(5527),m=t(890),f=t(1889),Z=t(9658),b=t(6151),j=t(168),g=t(2348),v=t(5702),y=(0,v.gql)(r||(r=(0,j.Z)(["\n  query getAccount($id: ObjectId) {\n    account(query: { _id: $id }) {\n      _id\n      type\n      number\n      balance\n      userId\n      currency\n      createdAt\n      transactions {\n        _id\n        number\n        amount\n        createdAt\n        description\n        destination_account\n      }\n    }\n  }\n"]))),P=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var t,r,a,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.queryVariables,r=void 0===t?{}:t,a=n.headers,i=void 0===a?{}:a,e.next=3,(0,v.request)(g.Z2,y,r,i);case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=P,k=t(6921),A=t(184),C=function(e){var n=e.data,t=new Date(n.createdAt),r="".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear());return(0,A.jsx)(f.ZP,{item:!0,xs:12,children:(0,A.jsx)(p.Z,{sx:{display:"flex",flexWrap:"wrap",padding:"20px",flex:"1",color:"white",background:"linear-gradient(90deg, rgb(22 118 210) 0%, rgb(185 136 255) 100%)"},children:(0,A.jsxs)(f.ZP,{container:!0,spacing:3,children:[(0,A.jsxs)(f.ZP,{item:!0,xs:12,md:6,lg:6,children:[(0,A.jsx)(m.Z,{children:"Balance"}),(0,A.jsxs)(m.Z,{variant:"h5",sx:{fontWeight:"bold",letterSpacing:"2px"},children:[g.oq,n.balance]})]}),(0,A.jsxs)(f.ZP,{item:!0,xs:12,md:6,lg:6,children:[(0,A.jsx)(m.Z,{children:"Account Number"}),(0,A.jsx)(m.Z,{variant:"h6",sx:{fontWeight:"bold",letterSpacing:"8px"},children:n.number})]}),(0,A.jsxs)(f.ZP,{item:!0,xs:12,md:6,lg:6,children:[(0,A.jsx)(m.Z,{children:"Account Type"}),(0,A.jsx)(m.Z,{variant:"h6",sx:{fontWeight:"bold",letterSpacing:"1px",textTransform:"capitalize"},children:n.type})]}),(0,A.jsxs)(f.ZP,{item:!0,xs:12,md:6,lg:6,children:[(0,A.jsx)(m.Z,{children:"Created On"}),(0,A.jsx)(m.Z,{variant:"h6",sx:{letterSpacing:"1px"},children:r})]})]})})})},S=t(3389),q=t(4851),T=(0,v.gql)(a||(a=(0,j.Z)(["\n  mutation updateAccount($query: AccountQueryInput, $set: AccountUpdateInput!) {\n    updateOneAccount(query: $query, set: $set) {\n      _id\n      type\n      number\n      balance\n      userId\n      currency\n      createdAt\n      transactions {\n        _id\n        number\n        amount\n        createdAt\n        description\n        source_account\n        destination_account\n      }\n    }\n  }\n"]))),_=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var t,r,a,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.updateAccountQueryVariables,r=void 0===t?{}:t,a=n.headers,i=void 0===a?{}:a,e.next=3,(0,v.request)(g.Z2,T,r,i);case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),I=_,V=t(5231),O=function(){var e=(0,l.useState)(!1),n=(0,u.Z)(e,2),t=n[0],r=n[1],a=(0,l.useContext)(x.S).user,i=(0,l.useState)([]),j=(0,u.Z)(i,2),v=j[0],y=j[1],P=(0,l.useState)(!0),T=(0,u.Z)(P,2),_=T[0],O=T[1],W=(0,l.useState)(!1),M=(0,u.Z)(W,2),F=M[0],$=M[1],N=(0,d.UO)(),B={Authorization:"Bearer ".concat(a._accessToken)},D={id:N.id},H=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({queryVariables:D,headers:B});case 2:n=e.sent,console.log("accountdata: ",JSON.stringify(n)),y(n.account),O(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){H()}),[]);var Q=function(){r(!t)},z=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var t,r,i,s,u,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(n.amount<=v.balance)){e.next=17;break}return t={data:{number:parseInt(Math.floor(1e12*Math.random())+1),amount:parseInt(n.amount),createdAt:new Date,userId:a.id,source_account:v.number,destination_account:n.destination_account,description:n.description}},e.next=6,(0,k.Z)({queryVariables:t,headers:B});case 6:return r=e.sent,i=v.transactions.map((function(e){return e.number})),s=[].concat((0,c.Z)(i||[]),["".concat(r.insertOneTransaction.number)]),u={query:{number:v.number},set:{balance:v.balance-r.insertOneTransaction.amount,transactions:{link:s}}},e.next=12,I({updateAccountQueryVariables:u,headers:B});case 12:l=e.sent,Q(),y(l.updateOneAccount),e.next=18;break;case 17:$("Transaction amount exceeds available balance.");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),$(e.t0.error);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(n){return e.apply(this,arguments)}}();return(0,A.jsxs)(h.Z,{children:[(0,A.jsx)(p.Z,{sx:{padding:"15px 20px",display:"flex",margin:"20px 0",backgroundColor:"#f9f9f9"},children:(0,A.jsx)(m.Z,{variant:"h5",sx:{flex:"1"},children:"Account Summary"})}),_?(0,A.jsx)(V.Z,{}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(f.ZP,{container:!0,spacing:2,children:v?(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(C,{data:v})}):(0,A.jsx)(f.ZP,{item:!0,children:(0,A.jsx)(Z.Z,{severity:"error",children:"No account detail found!"})})}),(0,A.jsxs)(p.Z,{sx:{padding:"15px 20px",display:"flex",margin:"20px 0",backgroundColor:"#f9f9f9"},children:[(0,A.jsx)(m.Z,{variant:"h5",sx:{flex:"1"},children:"Recent Transactions"}),(0,A.jsx)(b.Z,{variant:"contained",onClick:function(){return r(!0)},children:"Make transaction"})]}),(0,A.jsx)(q.Z,{createTransactionFormSubmitHandler:z,createTransactionApiError:F,openCreateTransactionModal:t,handleModalClose:Q}),v&&v.transactions&&v.transactions.length?(0,A.jsx)(S.Z,{data:v.transactions,tableHeadings:g.QP}):(0,A.jsx)(Z.Z,{severity:"error",children:"No transaction found!"})]})]})},W=function(){return(0,A.jsx)(i.Z,{children:(0,A.jsx)(O,{})})}}}]);
//# sourceMappingURL=22.fc972876.chunk.js.map